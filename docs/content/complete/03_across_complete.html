<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Across – Advanced R for Data Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Advanced R for Data Science</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introducing-across" id="toc-introducing-across" class="nav-link active" data-scroll-target="#introducing-across">Introducing across()</a></li>
  <li><a href="#more-across-examples" id="toc-more-across-examples" class="nav-link" data-scroll-target="#more-across-examples">More across examples</a>
  <ul class="collapse">
  <li><a href="#add-100-to-all-age_-columns" id="toc-add-100-to-all-age_-columns" class="nav-link" data-scroll-target="#add-100-to-all-age_-columns">Add 100 to all <code>age_</code> columns</a></li>
  <li><a href="#convert-born_usa-and-citizen_usa-to-numeric-binary-columns-using-ends_with" id="toc-convert-born_usa-and-citizen_usa-to-numeric-binary-columns-using-ends_with" class="nav-link" data-scroll-target="#convert-born_usa-and-citizen_usa-to-numeric-binary-columns-using-ends_with">Convert <code>born_usa</code> and <code>citizen_usa</code> to numeric (binary) columns using <code>ends_with()</code></a></li>
  <li><a href="#convert-born_usa-and-citizen_usa-to-numeric-binary-columns-using-a-vector-of-column-names" id="toc-convert-born_usa-and-citizen_usa-to-numeric-binary-columns-using-a-vector-of-column-names" class="nav-link" data-scroll-target="#convert-born_usa-and-citizen_usa-to-numeric-binary-columns-using-a-vector-of-column-names">Convert <code>born_usa</code> and <code>citizen_usa</code> to numeric (binary) columns using a vector of column names</a></li>
  </ul></li>
  <li><a href="#select-helpers-summary" id="toc-select-helpers-summary" class="nav-link" data-scroll-target="#select-helpers-summary">Select helpers summary</a>
  <ul class="collapse">
  <li><a href="#exercise" id="toc-exercise" class="nav-link" data-scroll-target="#exercise">Exercise</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Across</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this lesson, we will introduce the <code>across()</code> function, which can be used to apply dplyr functions like mutate, summarize, select, etc to subsets of columns that satisfy certain criteria, such as to all numeric columns, or all columns that start with <code>age_</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the tidyverse and demographics dataset</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>demographics <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/demographics.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 10175 Columns: 19
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (5): interview_examination, gender, race, marital_status, pregnant
dbl (9): respondent_id, age_years, age_months_sc_0_2yr, six_month_period, ag...
lgl (5): served_active_duty_us, served_active_duty_foreign, born_usa, citize...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(demographics)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 19
  respondent_id interview_examination gender age_years age_months_sc_0_2yr race 
          &lt;dbl&gt; &lt;chr&gt;                 &lt;chr&gt;      &lt;dbl&gt;               &lt;dbl&gt; &lt;chr&gt;
1         73557 both interview and e… male          69                  NA black
2         73558 both interview and e… male          54                  NA white
3         73559 both interview and e… male          72                  NA white
4         73560 both interview and e… male           9                  NA white
5         73561 both interview and e… female        73                  NA white
6         73562 both interview and e… male          56                  NA mexi…
# ℹ 13 more variables: six_month_period &lt;dbl&gt;, age_months_ex_0_19yr &lt;dbl&gt;,
#   served_active_duty_us &lt;lgl&gt;, served_active_duty_foreign &lt;lgl&gt;,
#   born_usa &lt;lgl&gt;, citizen_usa &lt;lgl&gt;, time_in_us &lt;dbl&gt;, education_youth &lt;dbl&gt;,
#   education &lt;dbl&gt;, marital_status &lt;chr&gt;, pregnant &lt;chr&gt;,
#   language_english &lt;lgl&gt;, household_income &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Let’s suppose that our task is to <strong>convert all character columns of the demographics data to upper-case</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># apply toupper() to the string value "abc"</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">toupper</span>(<span class="st">"abc"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ABC"</code></pre>
</div>
</div>
<p>Before introducing across, let’s first see one way that we could do this using the <code>map()</code> functions that we have just learned:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a copy of demographics</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>demographics_tmp <span class="ot">&lt;-</span> demographics</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># create a logical vector for identifying character columns using map_chr()</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>character_cols <span class="ot">&lt;-</span> <span class="fu">map_chr</span>(demographics_tmp, class) <span class="sc">==</span> <span class="st">"character"</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># re-assign the character columns to an upper-case version of themselves </span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># using map_df() applied to demographics_tmp[character_cols] with toupper()</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>demographics_tmp[character_cols] <span class="ot">&lt;-</span> <span class="fu">map_df</span>(demographics_tmp[character_cols], toupper)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># look at demographics_tmp</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>demographics_tmp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10,175 × 19
   respondent_id interview_examination   gender age_years age_months_sc_0_2yr
           &lt;dbl&gt; &lt;chr&gt;                   &lt;chr&gt;      &lt;dbl&gt;               &lt;dbl&gt;
 1         73557 BOTH INTERVIEW AND EXAM MALE          69                  NA
 2         73558 BOTH INTERVIEW AND EXAM MALE          54                  NA
 3         73559 BOTH INTERVIEW AND EXAM MALE          72                  NA
 4         73560 BOTH INTERVIEW AND EXAM MALE           9                  NA
 5         73561 BOTH INTERVIEW AND EXAM FEMALE        73                  NA
 6         73562 BOTH INTERVIEW AND EXAM MALE          56                  NA
 7         73563 BOTH INTERVIEW AND EXAM MALE           0                   5
 8         73564 BOTH INTERVIEW AND EXAM FEMALE        61                  NA
 9         73565 INTERVIEW ONLY          MALE          42                  NA
10         73566 BOTH INTERVIEW AND EXAM FEMALE        56                  NA
# ℹ 10,165 more rows
# ℹ 14 more variables: race &lt;chr&gt;, six_month_period &lt;dbl&gt;,
#   age_months_ex_0_19yr &lt;dbl&gt;, served_active_duty_us &lt;lgl&gt;,
#   served_active_duty_foreign &lt;lgl&gt;, born_usa &lt;lgl&gt;, citizen_usa &lt;lgl&gt;,
#   time_in_us &lt;dbl&gt;, education_youth &lt;dbl&gt;, education &lt;dbl&gt;,
#   marital_status &lt;chr&gt;, pregnant &lt;chr&gt;, language_english &lt;lgl&gt;,
#   household_income &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># look at demographics (it should still have lowercase)</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>demographics</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10,175 × 19
   respondent_id interview_examination   gender age_years age_months_sc_0_2yr
           &lt;dbl&gt; &lt;chr&gt;                   &lt;chr&gt;      &lt;dbl&gt;               &lt;dbl&gt;
 1         73557 both interview and exam male          69                  NA
 2         73558 both interview and exam male          54                  NA
 3         73559 both interview and exam male          72                  NA
 4         73560 both interview and exam male           9                  NA
 5         73561 both interview and exam female        73                  NA
 6         73562 both interview and exam male          56                  NA
 7         73563 both interview and exam male           0                   5
 8         73564 both interview and exam female        61                  NA
 9         73565 interview only          male          42                  NA
10         73566 both interview and exam female        56                  NA
# ℹ 10,165 more rows
# ℹ 14 more variables: race &lt;chr&gt;, six_month_period &lt;dbl&gt;,
#   age_months_ex_0_19yr &lt;dbl&gt;, served_active_duty_us &lt;lgl&gt;,
#   served_active_duty_foreign &lt;lgl&gt;, born_usa &lt;lgl&gt;, citizen_usa &lt;lgl&gt;,
#   time_in_us &lt;dbl&gt;, education_youth &lt;dbl&gt;, education &lt;dbl&gt;,
#   marital_status &lt;chr&gt;, pregnant &lt;chr&gt;, language_english &lt;lgl&gt;,
#   household_income &lt;dbl&gt;</code></pre>
</div>
</div>
<p>While this works, it is fairly convoluted, is hard to read, and involves defining an intermediate variable (<code>character_cols</code>) – in the tidyverse style, it is generally recommended to <em>avoid</em> defining intermediate variables whenever possible.</p>
<section id="introducing-across" class="level2">
<h2 class="anchored" data-anchor-id="introducing-across">Introducing across()</h2>
<p>We could instead do this kind of operation using a <code>mutate()</code> operation in conjunction with <code>across()</code>.</p>
<p>Let’s figure out the code for just one column first</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># apply toupper to interview_examination with mutate</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>demographics <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">interview_examination =</span> <span class="fu">toupper</span>(interview_examination))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10,175 × 19
   respondent_id interview_examination   gender age_years age_months_sc_0_2yr
           &lt;dbl&gt; &lt;chr&gt;                   &lt;chr&gt;      &lt;dbl&gt;               &lt;dbl&gt;
 1         73557 BOTH INTERVIEW AND EXAM male          69                  NA
 2         73558 BOTH INTERVIEW AND EXAM male          54                  NA
 3         73559 BOTH INTERVIEW AND EXAM male          72                  NA
 4         73560 BOTH INTERVIEW AND EXAM male           9                  NA
 5         73561 BOTH INTERVIEW AND EXAM female        73                  NA
 6         73562 BOTH INTERVIEW AND EXAM male          56                  NA
 7         73563 BOTH INTERVIEW AND EXAM male           0                   5
 8         73564 BOTH INTERVIEW AND EXAM female        61                  NA
 9         73565 INTERVIEW ONLY          male          42                  NA
10         73566 BOTH INTERVIEW AND EXAM female        56                  NA
# ℹ 10,165 more rows
# ℹ 14 more variables: race &lt;chr&gt;, six_month_period &lt;dbl&gt;,
#   age_months_ex_0_19yr &lt;dbl&gt;, served_active_duty_us &lt;lgl&gt;,
#   served_active_duty_foreign &lt;lgl&gt;, born_usa &lt;lgl&gt;, citizen_usa &lt;lgl&gt;,
#   time_in_us &lt;dbl&gt;, education_youth &lt;dbl&gt;, education &lt;dbl&gt;,
#   marital_status &lt;chr&gt;, pregnant &lt;chr&gt;, language_english &lt;lgl&gt;,
#   household_income &lt;dbl&gt;</code></pre>
</div>
</div>
<p>To do this for <em>all character</em> columns, you need to provide <code>across()</code> to the argument of your mutate function. The <code>across()</code> function has two arguments:</p>
<ul>
<li><p>The first argument is a “select statement” that specifies which columns you want to apply your function to.</p></li>
<li><p>The second argument is the function name, <code>toupper</code>, that we want to apply to all columns that are selected as a result of the first argument.</p></li>
</ul>
<p>The result is that <code>toupper()</code> is applied to all columns “where” <code>is.character()</code> would result in <code>TRUE</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use across inside mutate to apply toupper() to all columns </span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># where(is.character) is TRUE...</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>demographics <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), toupper))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10,175 × 19
   respondent_id interview_examination   gender age_years age_months_sc_0_2yr
           &lt;dbl&gt; &lt;chr&gt;                   &lt;chr&gt;      &lt;dbl&gt;               &lt;dbl&gt;
 1         73557 BOTH INTERVIEW AND EXAM MALE          69                  NA
 2         73558 BOTH INTERVIEW AND EXAM MALE          54                  NA
 3         73559 BOTH INTERVIEW AND EXAM MALE          72                  NA
 4         73560 BOTH INTERVIEW AND EXAM MALE           9                  NA
 5         73561 BOTH INTERVIEW AND EXAM FEMALE        73                  NA
 6         73562 BOTH INTERVIEW AND EXAM MALE          56                  NA
 7         73563 BOTH INTERVIEW AND EXAM MALE           0                   5
 8         73564 BOTH INTERVIEW AND EXAM FEMALE        61                  NA
 9         73565 INTERVIEW ONLY          MALE          42                  NA
10         73566 BOTH INTERVIEW AND EXAM FEMALE        56                  NA
# ℹ 10,165 more rows
# ℹ 14 more variables: race &lt;chr&gt;, six_month_period &lt;dbl&gt;,
#   age_months_ex_0_19yr &lt;dbl&gt;, served_active_duty_us &lt;lgl&gt;,
#   served_active_duty_foreign &lt;lgl&gt;, born_usa &lt;lgl&gt;, citizen_usa &lt;lgl&gt;,
#   time_in_us &lt;dbl&gt;, education_youth &lt;dbl&gt;, education &lt;dbl&gt;,
#   marital_status &lt;chr&gt;, pregnant &lt;chr&gt;, language_english &lt;lgl&gt;,
#   household_income &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="more-across-examples" class="level2">
<h2 class="anchored" data-anchor-id="more-across-examples">More across examples</h2>
<section id="add-100-to-all-age_-columns" class="level3">
<h3 class="anchored" data-anchor-id="add-100-to-all-age_-columns">Add 100 to all <code>age_</code> columns</h3>
<p>If we were to do this to just the <code>age_years</code> column, our code would look like:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use mutate to add 100 to age_years</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>demographics <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">age_years =</span> age_years <span class="sc">+</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10,175 × 19
   respondent_id interview_examination   gender age_years age_months_sc_0_2yr
           &lt;dbl&gt; &lt;chr&gt;                   &lt;chr&gt;      &lt;dbl&gt;               &lt;dbl&gt;
 1         73557 both interview and exam male         169                  NA
 2         73558 both interview and exam male         154                  NA
 3         73559 both interview and exam male         172                  NA
 4         73560 both interview and exam male         109                  NA
 5         73561 both interview and exam female       173                  NA
 6         73562 both interview and exam male         156                  NA
 7         73563 both interview and exam male         100                   5
 8         73564 both interview and exam female       161                  NA
 9         73565 interview only          male         142                  NA
10         73566 both interview and exam female       156                  NA
# ℹ 10,165 more rows
# ℹ 14 more variables: race &lt;chr&gt;, six_month_period &lt;dbl&gt;,
#   age_months_ex_0_19yr &lt;dbl&gt;, served_active_duty_us &lt;lgl&gt;,
#   served_active_duty_foreign &lt;lgl&gt;, born_usa &lt;lgl&gt;, citizen_usa &lt;lgl&gt;,
#   time_in_us &lt;dbl&gt;, education_youth &lt;dbl&gt;, education &lt;dbl&gt;,
#   marital_status &lt;chr&gt;, pregnant &lt;chr&gt;, language_english &lt;lgl&gt;,
#   household_income &lt;dbl&gt;</code></pre>
</div>
</div>
<p>To generalize this to all columns that start with <code>age_</code> using <code>across()</code>, we can use the <code>starts_with()</code> select helper, and apply the anonymous function <code>~{. + 100}</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use across inside mutate to apply ~{. + 100} to all columns </span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># that starts_with("age_")...</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>demographics <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"age_"</span>), <span class="sc">~</span>{. <span class="sc">+</span> <span class="dv">100</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10,175 × 19
   respondent_id interview_examination   gender age_years age_months_sc_0_2yr
           &lt;dbl&gt; &lt;chr&gt;                   &lt;chr&gt;      &lt;dbl&gt;               &lt;dbl&gt;
 1         73557 both interview and exam male         169                  NA
 2         73558 both interview and exam male         154                  NA
 3         73559 both interview and exam male         172                  NA
 4         73560 both interview and exam male         109                  NA
 5         73561 both interview and exam female       173                  NA
 6         73562 both interview and exam male         156                  NA
 7         73563 both interview and exam male         100                 105
 8         73564 both interview and exam female       161                  NA
 9         73565 interview only          male         142                  NA
10         73566 both interview and exam female       156                  NA
# ℹ 10,165 more rows
# ℹ 14 more variables: race &lt;chr&gt;, six_month_period &lt;dbl&gt;,
#   age_months_ex_0_19yr &lt;dbl&gt;, served_active_duty_us &lt;lgl&gt;,
#   served_active_duty_foreign &lt;lgl&gt;, born_usa &lt;lgl&gt;, citizen_usa &lt;lgl&gt;,
#   time_in_us &lt;dbl&gt;, education_youth &lt;dbl&gt;, education &lt;dbl&gt;,
#   marital_status &lt;chr&gt;, pregnant &lt;chr&gt;, language_english &lt;lgl&gt;,
#   household_income &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="convert-born_usa-and-citizen_usa-to-numeric-binary-columns-using-ends_with" class="level3">
<h3 class="anchored" data-anchor-id="convert-born_usa-and-citizen_usa-to-numeric-binary-columns-using-ends_with">Convert <code>born_usa</code> and <code>citizen_usa</code> to numeric (binary) columns using <code>ends_with()</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># take a look at born_usa and citizen_use using select()</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>demographics <span class="sc">|&gt;</span> <span class="fu">select</span>(born_usa, citizen_usa)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10,175 × 2
   born_usa citizen_usa
   &lt;lgl&gt;    &lt;lgl&gt;      
 1 TRUE     TRUE       
 2 TRUE     TRUE       
 3 TRUE     TRUE       
 4 TRUE     TRUE       
 5 TRUE     TRUE       
 6 TRUE     TRUE       
 7 TRUE     TRUE       
 8 TRUE     TRUE       
 9 TRUE     TRUE       
10 TRUE     TRUE       
# ℹ 10,165 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use across inside mutate to apply as.numeric to all columns </span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># that ends_with("_usa")...</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>demographics <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">ends_with</span>(<span class="st">"_usa"</span>), as.numeric)) <span class="sc">|&gt;</span> </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">width =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10,175 × 19
   respondent_id interview_examination   gender age_years age_months_sc_0_2yr
           &lt;dbl&gt; &lt;chr&gt;                   &lt;chr&gt;      &lt;dbl&gt;               &lt;dbl&gt;
 1         73557 both interview and exam male          69                  NA
 2         73558 both interview and exam male          54                  NA
 3         73559 both interview and exam male          72                  NA
 4         73560 both interview and exam male           9                  NA
 5         73561 both interview and exam female        73                  NA
 6         73562 both interview and exam male          56                  NA
 7         73563 both interview and exam male           0                   5
 8         73564 both interview and exam female        61                  NA
 9         73565 interview only          male          42                  NA
10         73566 both interview and exam female        56                  NA
   race             six_month_period age_months_ex_0_19yr served_active_duty_us
   &lt;chr&gt;                       &lt;dbl&gt;                &lt;dbl&gt; &lt;lgl&gt;                
 1 black                           1                   NA TRUE                 
 2 white                           1                   NA FALSE                
 3 white                           2                   NA TRUE                 
 4 white                           1                  119 NA                   
 5 white                           1                   NA FALSE                
 6 mexican american                1                   NA TRUE                 
 7 white                           2                    6 NA                   
 8 white                           2                   NA FALSE                
 9 other hispanic                 NA                   NA FALSE                
10 white                           1                   NA FALSE                
   served_active_duty_foreign born_usa citizen_usa time_in_us education_youth
   &lt;lgl&gt;                         &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;           &lt;dbl&gt;
 1 TRUE                              1           1         NA              NA
 2 NA                                1           1         NA              NA
 3 TRUE                              1           1         NA              NA
 4 NA                                1           1         NA               3
 5 NA                                1           1         NA              NA
 6 FALSE                             1           1         NA              NA
 7 NA                                1           1         NA              NA
 8 NA                                1           1         NA              NA
 9 NA                                1           1         NA              NA
10 NA                                1           1         NA              NA
   education marital_status pregnant language_english household_income
       &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;    &lt;lgl&gt;                       &lt;dbl&gt;
 1         3 separated      &lt;NA&gt;     TRUE                        17500
 2         3 married        &lt;NA&gt;     TRUE                        40000
 3         4 married        &lt;NA&gt;     TRUE                        70000
 4        NA &lt;NA&gt;           &lt;NA&gt;     TRUE                        60000
 5         5 married        &lt;NA&gt;     TRUE                       100000
 6         4 divorced       &lt;NA&gt;     TRUE                        60000
 7        NA &lt;NA&gt;           &lt;NA&gt;     TRUE                       100000
 8         5 widowed        &lt;NA&gt;     TRUE                        70000
 9         3 married        &lt;NA&gt;     TRUE                       100000
10         3 divorced       &lt;NA&gt;     TRUE                        17500
# ℹ 10,165 more rows</code></pre>
</div>
</div>
</section>
<section id="convert-born_usa-and-citizen_usa-to-numeric-binary-columns-using-a-vector-of-column-names" class="level3">
<h3 class="anchored" data-anchor-id="convert-born_usa-and-citizen_usa-to-numeric-binary-columns-using-a-vector-of-column-names">Convert <code>born_usa</code> and <code>citizen_usa</code> to numeric (binary) columns using a vector of column names</h3>
<p>Suppose we had a vector of column names that we wanted to modify using <code>mutate()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define a vector selected_columns with "born_usa" and "citizen_usa"</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>selected_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"born_usa"</span>, <span class="st">"citizen_usa"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then we could use <code>all_of(selected_cols)</code> in <code>across()</code> to apply the function to all columns listed in the <code>selected_cols</code> vector as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use across inside mutate to apply as.numeric to all_of(selected_columns)</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>demographics <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(selected_cols), as.numeric)) <span class="sc">|&gt;</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">width =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10,175 × 19
   respondent_id interview_examination   gender age_years age_months_sc_0_2yr
           &lt;dbl&gt; &lt;chr&gt;                   &lt;chr&gt;      &lt;dbl&gt;               &lt;dbl&gt;
 1         73557 both interview and exam male          69                  NA
 2         73558 both interview and exam male          54                  NA
 3         73559 both interview and exam male          72                  NA
 4         73560 both interview and exam male           9                  NA
 5         73561 both interview and exam female        73                  NA
 6         73562 both interview and exam male          56                  NA
 7         73563 both interview and exam male           0                   5
 8         73564 both interview and exam female        61                  NA
 9         73565 interview only          male          42                  NA
10         73566 both interview and exam female        56                  NA
   race             six_month_period age_months_ex_0_19yr served_active_duty_us
   &lt;chr&gt;                       &lt;dbl&gt;                &lt;dbl&gt; &lt;lgl&gt;                
 1 black                           1                   NA TRUE                 
 2 white                           1                   NA FALSE                
 3 white                           2                   NA TRUE                 
 4 white                           1                  119 NA                   
 5 white                           1                   NA FALSE                
 6 mexican american                1                   NA TRUE                 
 7 white                           2                    6 NA                   
 8 white                           2                   NA FALSE                
 9 other hispanic                 NA                   NA FALSE                
10 white                           1                   NA FALSE                
   served_active_duty_foreign born_usa citizen_usa time_in_us education_youth
   &lt;lgl&gt;                         &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;           &lt;dbl&gt;
 1 TRUE                              1           1         NA              NA
 2 NA                                1           1         NA              NA
 3 TRUE                              1           1         NA              NA
 4 NA                                1           1         NA               3
 5 NA                                1           1         NA              NA
 6 FALSE                             1           1         NA              NA
 7 NA                                1           1         NA              NA
 8 NA                                1           1         NA              NA
 9 NA                                1           1         NA              NA
10 NA                                1           1         NA              NA
   education marital_status pregnant language_english household_income
       &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;    &lt;lgl&gt;                       &lt;dbl&gt;
 1         3 separated      &lt;NA&gt;     TRUE                        17500
 2         3 married        &lt;NA&gt;     TRUE                        40000
 3         4 married        &lt;NA&gt;     TRUE                        70000
 4        NA &lt;NA&gt;           &lt;NA&gt;     TRUE                        60000
 5         5 married        &lt;NA&gt;     TRUE                       100000
 6         4 divorced       &lt;NA&gt;     TRUE                        60000
 7        NA &lt;NA&gt;           &lt;NA&gt;     TRUE                       100000
 8         5 widowed        &lt;NA&gt;     TRUE                        70000
 9         3 married        &lt;NA&gt;     TRUE                       100000
10         3 divorced       &lt;NA&gt;     TRUE                        17500
# ℹ 10,165 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="select-helpers-summary" class="level2">
<h2 class="anchored" data-anchor-id="select-helpers-summary">Select helpers summary</h2>
<p>So far we have seen the following “select helpers” that can be used to specify the columns inside <code>across()</code>:</p>
<ul>
<li><p><code>where()</code> – across to all columns that satisfy a logical condition (<code>across(where(is.character), fun)</code>)</p></li>
<li><p><code>starts_with()</code> and <code>ends_with()</code> – across all columns that start or ends with a specified string (<code>across(starts_with("abc"), fun)</code>)</p></li>
<li><p><code>contains()</code> – across all columns that contain a specified string (<code>across(contains("abc"), fun)</code>)</p></li>
<li><p><code>all_of()</code> and <code>any_of()</code> – across all columns whose names are contained in a character vector, where <code>all_of()</code> requires all columns in the vector be present. (<code>across(all_of(vec_names), fun)</code>)</p></li>
<li><p><code>everything()</code> – across all columns</p></li>
</ul>
<p>These can also be used within <code>select()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select all columns that contain "age"</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>demographics <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">"age"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10,175 × 4
   age_years age_months_sc_0_2yr age_months_ex_0_19yr language_english
       &lt;dbl&gt;               &lt;dbl&gt;                &lt;dbl&gt; &lt;lgl&gt;           
 1        69                  NA                   NA TRUE            
 2        54                  NA                   NA TRUE            
 3        72                  NA                   NA TRUE            
 4         9                  NA                  119 TRUE            
 5        73                  NA                   NA TRUE            
 6        56                  NA                   NA TRUE            
 7         0                   5                    6 TRUE            
 8        61                  NA                   NA TRUE            
 9        42                  NA                   NA TRUE            
10        56                  NA                   NA TRUE            
# ℹ 10,165 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select all columns that start with "age"</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>demographics <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"age"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10,175 × 3
   age_years age_months_sc_0_2yr age_months_ex_0_19yr
       &lt;dbl&gt;               &lt;dbl&gt;                &lt;dbl&gt;
 1        69                  NA                   NA
 2        54                  NA                   NA
 3        72                  NA                   NA
 4         9                  NA                  119
 5        73                  NA                   NA
 6        56                  NA                   NA
 7         0                   5                    6
 8        61                  NA                   NA
 9        42                  NA                   NA
10        56                  NA                   NA
# ℹ 10,165 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select all columns that have a logical type</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>demographics <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">where</span>(is.logical))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10,175 × 5
   served_active_duty_us served_active_duty_foreign born_usa citizen_usa
   &lt;lgl&gt;                 &lt;lgl&gt;                      &lt;lgl&gt;    &lt;lgl&gt;      
 1 TRUE                  TRUE                       TRUE     TRUE       
 2 FALSE                 NA                         TRUE     TRUE       
 3 TRUE                  TRUE                       TRUE     TRUE       
 4 NA                    NA                         TRUE     TRUE       
 5 FALSE                 NA                         TRUE     TRUE       
 6 TRUE                  FALSE                      TRUE     TRUE       
 7 NA                    NA                         TRUE     TRUE       
 8 FALSE                 NA                         TRUE     TRUE       
 9 FALSE                 NA                         TRUE     TRUE       
10 FALSE                 NA                         TRUE     TRUE       
# ℹ 10,165 more rows
# ℹ 1 more variable: language_english &lt;lgl&gt;</code></pre>
</div>
</div>
<section id="exercise" class="level3">
<h3 class="anchored" data-anchor-id="exercise">Exercise</h3>
<ol type="a">
<li><p>For all columns that contain the word “education” (<code>education_youth</code> and <code>education</code>), add the number 5 to each value</p></li>
<li><p>For all numeric columns, standardize the values by subtracting the mean and dividing by the standard deviation</p></li>
<li><p>Compute the average age across all columns that start with <code>age_</code> (Hint: use <code>across()</code> within <code>summarize()</code>)</p></li>
<li><p>Compute the total number of <code>TRUE</code> values in the <code>born_usa</code>, <code>citizen_usa</code>, and <code>language_english</code> columns (Hint: use <code>across()</code> within <code>summarize()</code>)</p></li>
</ol>
<section id="solution" class="level4">
<h4 class="anchored" data-anchor-id="solution">Solution</h4>
<ol type="a">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>demographics <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">across</span>(</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">contains</span>(<span class="st">"education"</span>), </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span>{. <span class="sc">+</span> <span class="dv">5</span>}</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">width =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10,175 × 19
   respondent_id interview_examination   gender age_years age_months_sc_0_2yr
           &lt;dbl&gt; &lt;chr&gt;                   &lt;chr&gt;      &lt;dbl&gt;               &lt;dbl&gt;
 1         73557 both interview and exam male          69                  NA
 2         73558 both interview and exam male          54                  NA
 3         73559 both interview and exam male          72                  NA
 4         73560 both interview and exam male           9                  NA
 5         73561 both interview and exam female        73                  NA
 6         73562 both interview and exam male          56                  NA
 7         73563 both interview and exam male           0                   5
 8         73564 both interview and exam female        61                  NA
 9         73565 interview only          male          42                  NA
10         73566 both interview and exam female        56                  NA
   race             six_month_period age_months_ex_0_19yr served_active_duty_us
   &lt;chr&gt;                       &lt;dbl&gt;                &lt;dbl&gt; &lt;lgl&gt;                
 1 black                           1                   NA TRUE                 
 2 white                           1                   NA FALSE                
 3 white                           2                   NA TRUE                 
 4 white                           1                  119 NA                   
 5 white                           1                   NA FALSE                
 6 mexican american                1                   NA TRUE                 
 7 white                           2                    6 NA                   
 8 white                           2                   NA FALSE                
 9 other hispanic                 NA                   NA FALSE                
10 white                           1                   NA FALSE                
   served_active_duty_foreign born_usa citizen_usa time_in_us education_youth
   &lt;lgl&gt;                      &lt;lgl&gt;    &lt;lgl&gt;            &lt;dbl&gt;           &lt;dbl&gt;
 1 TRUE                       TRUE     TRUE                NA              NA
 2 NA                         TRUE     TRUE                NA              NA
 3 TRUE                       TRUE     TRUE                NA              NA
 4 NA                         TRUE     TRUE                NA               8
 5 NA                         TRUE     TRUE                NA              NA
 6 FALSE                      TRUE     TRUE                NA              NA
 7 NA                         TRUE     TRUE                NA              NA
 8 NA                         TRUE     TRUE                NA              NA
 9 NA                         TRUE     TRUE                NA              NA
10 NA                         TRUE     TRUE                NA              NA
   education marital_status pregnant language_english household_income
       &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;    &lt;lgl&gt;                       &lt;dbl&gt;
 1         8 separated      &lt;NA&gt;     TRUE                        17500
 2         8 married        &lt;NA&gt;     TRUE                        40000
 3         9 married        &lt;NA&gt;     TRUE                        70000
 4        NA &lt;NA&gt;           &lt;NA&gt;     TRUE                        60000
 5        10 married        &lt;NA&gt;     TRUE                       100000
 6         9 divorced       &lt;NA&gt;     TRUE                        60000
 7        NA &lt;NA&gt;           &lt;NA&gt;     TRUE                       100000
 8        10 widowed        &lt;NA&gt;     TRUE                        70000
 9         8 married        &lt;NA&gt;     TRUE                       100000
10         8 divorced       &lt;NA&gt;     TRUE                        17500
# ℹ 10,165 more rows</code></pre>
</div>
</div>
<ol start="2" type="a">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># standardize all numeric columns</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>demographics <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">across</span>(</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">where</span>(is.numeric), </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span>{(. <span class="sc">-</span> <span class="fu">mean</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">/</span> <span class="fu">sd</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>)}</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10,175 × 19
   respondent_id interview_examination   gender age_years age_months_sc_0_2yr
           &lt;dbl&gt; &lt;chr&gt;                   &lt;chr&gt;      &lt;dbl&gt;               &lt;dbl&gt;
 1         -1.73 both interview and exam male       1.54               NA    
 2         -1.73 both interview and exam male       0.922              NA    
 3         -1.73 both interview and exam male       1.66               NA    
 4         -1.73 both interview and exam male      -0.921              NA    
 5         -1.73 both interview and exam female     1.70               NA    
 6         -1.73 both interview and exam male       1.00               NA    
 7         -1.73 both interview and exam male      -1.29               -0.776
 8         -1.73 both interview and exam female     1.21               NA    
 9         -1.73 interview only          male       0.431              NA    
10         -1.73 both interview and exam female     1.00               NA    
# ℹ 10,165 more rows
# ℹ 14 more variables: race &lt;chr&gt;, six_month_period &lt;dbl&gt;,
#   age_months_ex_0_19yr &lt;dbl&gt;, served_active_duty_us &lt;lgl&gt;,
#   served_active_duty_foreign &lt;lgl&gt;, born_usa &lt;lgl&gt;, citizen_usa &lt;lgl&gt;,
#   time_in_us &lt;dbl&gt;, education_youth &lt;dbl&gt;, education &lt;dbl&gt;,
#   marital_status &lt;chr&gt;, pregnant &lt;chr&gt;, language_english &lt;lgl&gt;,
#   household_income &lt;dbl&gt;</code></pre>
</div>
</div>
<ol start="3" type="a">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute average age across all age columns</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>demographics <span class="sc">|&gt;</span> <span class="fu">summarize</span>(</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">across</span>(</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">starts_with</span>(<span class="st">"age"</span>), </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span><span class="fu">mean</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  age_years age_months_sc_0_2yr age_months_ex_0_19yr
      &lt;dbl&gt;               &lt;dbl&gt;                &lt;dbl&gt;
1      31.5                10.3                 107.</code></pre>
</div>
</div>
<ol start="4" type="a">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the total in the `born_usa`, `citizen_usa`, and `language_english`</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>demographics <span class="sc">|&gt;</span> <span class="fu">summarise</span>(</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">across</span>(</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">any_of</span>(<span class="fu">c</span>(<span class="st">"born_usa"</span>, <span class="st">"citizen_usa"</span>, <span class="st">"language_english"</span>)),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span><span class="fu">sum</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  born_usa citizen_usa language_english
     &lt;int&gt;       &lt;int&gt;            &lt;int&gt;
1     8262        9220             9100</code></pre>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>